<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.1.6/js/intlTelInput.min.js"></script>
<script src="https://cdn.tiny.cloud/1/lulvxl9bdhscz1sjm3g5aqf8corf2vjs234gr6k0vk8mhtx0/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

<div class="whatsapp_generator" id="whatsapp">
  <div class="container">
    <h1>
      {{ module.title }}
    </h1>
    <div class="summary">
      {{ module.summary }}
    </div>
    <div class="generator">
      <div class="content">
        <div class="left_content">
          <div class="before_content">
            <h3>{{ module.left_title }}</h3>
            <p>{{ module.content }}</p>
            <div class="phone_number">
              <input type="tel" id="phone" name="phone" v-model="number" placeholder="{{ module.phone_placeholder }}">
            </div>
            <textarea id="message" maxlength="100" name="message" value="" type="text" placeholder="{{ module.message_placeholder }}"></textarea>
            <button type="button" class="btn btn-primary" id="generate-url" disabled>{{ module.generate_link }}</button>
          </div>

          <div class="generated_content">
            <span class="go_back">
              <img src="https://www.hello-charles.com/hubfs/Vector%20(1).png" alt="arrow left | charles">
            </span>
            <h3>{{ module.generated_title }}</h3>
            <div class="link_box">
              <input type="text" value="chrls.wa/12345" id="generated-url">
              <span><img src="https://www.hello-charles.com/hubfs/copy.png" alt="copy text icon | charles"></span>
            </div>
            <p>{{ module.generated_content }}</p>
            <h3 class="qr_download">{{ module.qr_download_text }}</h3>
            <a class="download" href="#" download="qr_code.png" rel="noopener noreferrer" target="_blank">{{ module.png_download_text }}</a>

            <!-- DOWNLOAD SVG FORMAT  -->
            <a class="download-svg" href="#" rel="noopener noreferrer" target="_blank" download>{{ module.svg_download_text }}</a>            
          </div>
        </div>
        <div class="right_content">
          <div class="placeholder_img">
            <img src="{{ module.right_image.src }}" alt="Phone background | charles">
            <p class="message"></p>
          </div>
          
          <div id="qr-code">
            <!-- Initially, don't set the src or set a placeholder image -->
            <img class="qr-code img-thumbnail img-responsive" alt="QR code preview | charles" />
            <span class="after-gen-message">{{ module.included_message }}</span>
            <div class="after-gen-inner-message">
              <span onclick="CopyToClipboard('generated-text')">
                <img src="https://www.hello-charles.com/hubfs/copy.png" alt="copy text icon | charles">
              </span>
              <p class="message after-generate" id="generated-text"></p>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
<script>
  const phoneInputField = document.querySelector("#phone");
  const phoneInput = window.intlTelInput(phoneInputField, {
    separateDialCode: true,
    initialCountry: "de",

    utilsScript:
    "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.1.6/js/utils.js",
  });

  // Copy generated text to clipboard  
  function CopyToClipboard(containerid) {
    // Create a range object to select the text node
    const range = document.createRange();
    range.selectNode(document.getElementById(containerid));

    // Add the range to the selection
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);

    // Copy the selected text to the clipboard
    try {
      document.execCommand('copy');
      console.log('Text copied to clipboard');
    } catch (err) {
      console.error('Unable to copy text: ', err);
    }

    // Remove the range from the selection
    selection.removeAllRanges();
  }

</script>